!function(){"use strict";var t=function(t){var n=document.querySelector(t);this.show=function(){n.classList.add("visible"),setTimeout(function(){this.hide()}.bind(this),5e3)}.bind(this),this.hide=function(){n.classList.remove("visible")}},n=function(){var t,n,o=new(window.AudioContext||window.webkitAudioContext),e=this,i=function(t){if(t=t||function(){},1==!!n)return void t(n);var e=new XMLHttpRequest;e.onload=function(){o.decodeAudioData(e.response,function(n){t(n)})},e.open("GET","/sounds/airhorn.mp3"),e.responseType="arraybuffer",e.send()};this.start=function(n){var s=n.loop;i(function(n){t=o.createBufferSource(),t.connect(o.destination),t.buffer=n,t.onended=function(){e.stop()},t.start(0),t.loop=s,t.loopStart=.24,t.loopEnd=.34})},this.stop=function(){t.loop=!1,this.onstopped()},this.onstopped=function(){};var s=function(){i(function(t){n=t})};s()},o=function(t){var o=t.querySelector(".horn"),e=new n,i=function(t){return 1==!!t&&(t.preventDefault(),t.touches&&t.touches.length>1)?!1:void this.start({loop:!1})},s=function(t){1==!!t&&t.preventDefault(),this.stop()};this.start=function(t){o.classList.add("horning"),e.start(t),e.onstopped=function(){o.classList.remove("horning")},ga("send","event","horn","play")},this.stop=function(){o.classList.remove("horning"),e.stop()},o.addEventListener("mousedown",i.bind(this)),o.addEventListener("touchstart",i.bind(this)),document.documentElement.addEventListener("mouseup",s.bind(this)),document.documentElement.addEventListener("touchend",s.bind(this))};window.addEventListener("load",function(){var t=document.getElementById("airhorn"),n=new o(t);"#instant"==location.hash&&n.start({loop:!1})}),window.addEventListener("beforeinstallprompt",function(n){n.userChoice.then(function(n){if("installed"==n.outcome){var o=new t("#installedToast");o.show()}})})}();
